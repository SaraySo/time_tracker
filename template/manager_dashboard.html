<!DOCTYPE html>
<html>
<head>
  <title>Manager Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <nav class="navbar navbar-light bg-white border-bottom mb-4">
    <div class="container">
      <span class="navbar-brand d-flex align-items-center gap-2">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" style="height:28px;width:auto;object-fit:contain"> Manager
      </span>
      <a class="btn btn-outline-secondary" href="{{ url_for('logout') }}">Logout</a>
    </div>
  </nav>
  <div class="container mb-3">
    <a class="btn btn-sm btn-outline-primary" href="{{ url_for('rates') }}">Edit Rates</a>
    <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('report') }}">Monthly Report</a>
    <a class="btn btn-sm btn-outline-primary" href="{{ url_for('list_logs') }}">Manage Logs</a>
    <a class="btn btn-sm btn-primary" href="{{ url_for('work_form') }}">My Work Page</a>
    <a class="btn btn-sm btn-success" href="{{ url_for('hours_report') }}">Hours Report</a>
  </div>
  <div class="container">
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h4 class="card-title mb-3">All logs</h4>
        <div class="table-responsive">
          <table class="table table-sm align-middle">
            <thead>
              <tr>
                <th>Date</th><th>Worker</th><th>Customer</th><th>Hours</th><th>Cost</th><th>Profit</th><th>Description</th>
              </tr>
            </thead>
            <tbody>
              {% for log in logs %}
              <tr>
                <td>{{ log[6] }}</td>
                <td>{{ log[0] }}</td>
                <td>{{ log[1] }}</td>
                <td>{{ log[2] }}</td>
                <td>{{ "%.2f"|format(log[3]) }} ₪</td>
                <td>{{ "%.2f"|format(log[4]) }} ₪</td>
                <td>{{ log[5] }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <div class="row g-3 mt-3">
          <div class="col">
            <div class="p-3 bg-light border rounded">
              <div class="small text-muted">Total Paid Out</div>
              <div class="fs-4">{{ "%.2f"|format(total_out) }} ₪</div>
            </div>
          </div>
          <div class="col">
            <div class="p-3 bg-light border rounded">
              <div class="small text-muted">Total Profit</div>
              <div class="fs-4">{{ "%.2f"|format(total_in) }} ₪</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row g-4">
      <div class="col-12 col-lg-6">
        {% if hours_by_worker %}
        <div class="card shadow-sm">
          <div class="card-body">
            <h4 class="card-title mb-3">Hours by Worker</h4>
            <table class="table table-sm">
              <thead><tr><th>Worker</th><th>Total Hours</th></tr></thead>
              <tbody>
              {% for w, h in hours_by_worker.items() %}
                <tr><td>{{ w }}</td><td>{{ "%.1f"|format(h) }}</td></tr>
              {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
        {% endif %}
      </div>
      <div class="col-12 col-lg-6">
        {% if hours_by_customer %}
        <div class="card shadow-sm">
          <div class="card-body">
            <h4 class="card-title mb-3">Hours by Customer</h4>
            <table class="table table-sm">
              <thead><tr><th>Customer</th><th>Total Hours</th></tr></thead>
              <tbody>
              {% for c, h in hours_by_customer.items() %}
                <tr><td>{{ c }}</td><td>{{ "%.1f"|format(h) }}</td></tr>
              {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
